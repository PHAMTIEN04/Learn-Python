import hashlib

# Function to convert text to SHA1 hash
def converted_text_to_sha1(text):
    digest = hashlib.sha1(text.encode()).hexdigest()
    return digest

# Main function to crack SHA1 hash
def main():
    # Prompt the user to enter the SHA1 hash to crack
    user_sha1 = input("Enter The SHA1 To Crack: ")
    
    # Clean and convert user's SHA1 hash to lowercase for consistency
    cleaned_user_sha1 = user_sha1.strip().lower()

    # Open the password file for reading
    with open("D:/Learn Python/Python Hacking/SHA1 Password Exploitation/password.txt") as f:
        # Read each line in the password file
        for line in f:
            # Remove leading/trailing whitespaces and newline characters
            password = line.strip()
            
            # Convert the password to SHA1 hash
            converted_sha1 = converted_text_to_sha1(password)
            
            # Compare the user's SHA1 hash with the converted password's SHA1 hash
            if cleaned_user_sha1 == converted_sha1:
                # If the hashes match, the password is found
                print(f"Password Found: {password}")
                return
            
    # If the loop completes without finding a matching password, print a message
    print("Could not find the password")

# Call the main function to start the SHA1 hash cracking process
main()
